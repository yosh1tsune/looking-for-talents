<h1>
    Inscrição: <%= @subscription.id %>
    <% if @subscription.highlighted == true %>
        <%# <img src="assets/images/highlighted.png" title="Highlight"> %>
    <% end %>
</h1>

<dl>
    <dt>Vaga:</dt>
    <dd><%= @subscription.opportunity.title %></dd>
    <dt>Candidato:</dt>
    <dd><%= @subscription.profile.name %></dd>
    <dt><%= I18n.t('status')%>:</dt>
    <dd><%= I18n.t(@subscription.status) %></dd>
    <dt><%= I18n.t('feedback')%>:</dt>
    <dd><%= @subscription.feedback %></dd>
</dl>

<% if headhunter_signed_in? %>
    <% if !@subscription.highlighted %>
        <%= button_to 'Destacar perfil', highlight_subscription_path(@subscription), method: :post, class: 'btn btn-success' %>
    <% else %>
        <%= button_to 'Remover destaque', highlight_subscription_path(@subscription), method: :post, class: 'btn btn-danger' %>
    <% end %>
<% end %>

<% if @subscription.in_progress? %>
    <% if @subscription.errors.any? %>
      <p>Você deve corrigir os seguintes erros: </p>
      <ul>
      <% @subscription.errors.full_messages.each do |message| %>
          <li><%= message %></li>
      <% end %>
      </ul><br><br>
    <% end %>
    <h3>Avaliar candidato<h3>
    <%= form_with model: @subscription, url: subscription_path, method: :put do |form| %>
        <p>
            <%= form.label :status %>
            <%= form.collection_select(:status, Subscription.statuses.map{ |s| [s.first]}, :first, :first ) %>
        </p>
        <p>
            <%= form.label :feedback %>
            <%= form.text_area :feedback %>
        </p>
            <%= form.submit 'Avaliar' %>
    <% end %>
<% end %>

<% if @subscription.proposal %>
  
<% elsif @subscription.approved? %>

  <h3 class="mt-4">Enviar proposta ao candidato</h3>
  
  <% if @proposal.errors.any? %>
    <p>Você deve corrigir os seguintes erros: </p>
    <ul>
    <% @proposal.errors.full_messages.each do |message| %>
        <li><%= message %></li>
    <% end %>
    </ul><br><br>
  <% end %>
  
  <hr class="my-4">

  <div class='col-md-4 mt-3 mb-3'>
    <%= form_for ([@subscription, @proposal]) do |form| %>  
      <div class='form-group'>
          <%= form.label :start_date %>
          <%= form.text_field :start_date, class: 'form-control'  %>
      </div>
      <div class='form-group'>
          <%= form.label :salary %>
          <%= form.number_field :salary, class: 'form-control'  %>
      </div>
      <div class='form-group'>
          <%= form.label :role %>
          <%= form.text_field :role, class: 'form-control'  %>
      </div>
      <div class='form-group'>
          <%= form.label :benefits %>
          <%= form.text_field :benefits, class: 'form-control'  %>
      </div>
      <div class='form-group'>
          <%= form.label :expectations %>
          <%= form.text_field :expectations, class: 'form-control'  %>
      </div>
      <div class='form-group'>
          <%= form.label :bonuses %>
          <%= form.text_field :bonuses, class: 'form-control'  %>
      </div>
      <%= form.submit 'Enviar proposta', class: 'btn btn-primary' %>
    <% end %>
  </div>
<% end %>