<h1><%= @opportunity.title %></h1>

<dl>
    <dt><%= t('company') %>:</dt>
    <dd><%= @opportunity.company %></dd>
    <dt><%= t('work_description') %>:</dt>
    <dd><%= @opportunity.work_description %></dd>
    <dt><%= t('required_abilities') %>:</dt>
    <dd><%= @opportunity.required_abilities %></dd>
    <dt><%= t('salary') %>:</dt>
    <dd><%= @opportunity.salary %></dd>
    <dt><%= t('grade') %>:</dt>
    <dd><%= @opportunity.grade %></dd>
    <dt><%= t('address') %>:</dt>
    <dd><%= @opportunity.address %></dd>
    <dt><%= t('submit_end_date') %>:</dt>
    <dd><%= I18n.localize @opportunity.submit_end_date %></dd>
</dl>

<% if candidate_signed_in? %>
    <% if @registered == nil %>
        <%= form_with model: @registration, url: subscriptions_path, method: :post do |form| %>
            <%= hidden_field_tag(:opportunity_id, @opportunity.id) %>
            <%= form.label :registration_resume, 'Resumo da inscrição' %>
            <%= form.text_area :registration_resume %>
            <%= form.submit 'Inscreva-se' %>
        <% end %>
    <% else %>
        <h3>Você já está inscrito nesta vaga. Aguarde instruções do recrutador.</h3>
    <% end %>
<% end %>

<% if headhunter_signed_in? %>
    <% if @opportunity.open? %>
        <%= link_to 'Encerrar inscrições', close_opportunity_path(@opportunity), method: :post%>
    <% end %>

    <h2>Candidatos Inscritos</h2>

    <% @registrations.each do |r| %>
        <dl>
            <h3>Inscrição: <%= link_to r.id, subscription_path(r) %>
            <dt><%= I18n.t('name') %>:</dt>
            <dd><%= link_to r.profile.name, profile_path(r) %></dd>
            <dt><%= I18n.t('registration_resume') %>:</dt>
            <dd><%= r.registration_resume %><dd>
            <dt><%= I18n.t('status') %>:</dt>
            <dd><%= r.status %><dd>
        </dl>
    <% end %>
<% end %>